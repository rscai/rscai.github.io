<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8" />
  <!-- multi-device width -->
  <meta content="width=device-width, initial-scale=1" name="viewport" />
  <!-- site description -->
  
  <meta content="We code for compiling." name="description" />
  <!-- referer for 3rd-part images-->
  <meta content="no-referrer" name="referrer" />
  <!-- title -->
  <title>
    
    Apply Repository Pattern by Spring Data
    
  </title>
  <!-- icon -->
  <link href="https://rscai.github.io/assets/img/favicon.ico?" rel="shortcut icon bookmark" type="image/x-icon" />
  <!-- main stylesheet -->
  <link rel="stylesheet" href="https://rscai.github.io/assets/css/main.css" type="text/css" />
  <!-- fa 5.9.0 -->
  <link rel="stylesheet" href="https://rscai.github.io/assets/css/fa.min.css" type="text/css" />
  <!-- rouge theme-->
  <link rel="stylesheet" href="https://rscai.github.io/assets/css/rouge-bg.css" />
  <!-- mathjax 2.7.5 -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
  </head>
  <body class="page">
    <!-- disable background animations -->

    <div class="container" id="ctner">
      <div class="header">
    <nav class="nav_bar">
        <ul>
            <!-- left header -->
            <li
                class="li_left">
                <!-- home -->
                
                    <a class="header_btn" href="https://rscai.github.io">
                        <i class="fa fa-home">
                            
                                <p class="btn_text">Home</p>
                            
                        </i>
                    </a>
                
                <!-- email -->
                
                    <a class="header_btn" href="mailto://">
                        <i class="fa fa-envelope-square">
                            
                                <p class="btn_text">Email</p>
                            
                        </i>
                    </a>
                
                <!-- github -->
                
                    <a class="header_btn" href="https://github.com/">
                        <i class="fa fa-github">
                            
                                <p class="btn_text">Github</p>
                            
                        </i>
                    </a>
                
                <!-- maximize -->
                
                    <a class="header_btn" id="mxmz_btn" onclick="toggle_maximize()">
                        <i class="fa fa-window-maximize">
                            
                                <p class="btn_text" id="mxmz_text">Maximize</p>
                            
                        </i>
                    </a>
                
                <!-- access token -->
                
            </li>
            <!-- right header -->
            <span
                class="span_right">
                <!-- popup table of content -->
                
                    <a class="header_btn" onclick="scroll_percentage(-0.88)">
                        <i class="fa fa-backward">
                            
                                <p class="btn_text">Prev</p>
                            
                        </i>
                    </a>
                    <!-- scroll down -->
                    <a class="header_btn" onclick="scroll_percentage(0.88)">
                        <i class="fa fa-forward">
                            
                                <p class="btn_text">Next</p>
                            
                        </i>
                    </a>
                    <!-- popup table of content -->
                    <a class="header_btn popup_btn" onclick="toggle_toc()">
                        <i class="fa fa-bars">
                            
                                <p class="btn_text">Content</p>
                            
                        </i>
                    </a>
                
            </span>
        </ul>
    </nav>
    <hr/>
</div>
<!-- table of content -->

    <div class="div_toc toc" id="popup_toc">
    
    <!-- generate toc -->
    <ul id="ul_toc" class="ul_toc">
  <li><a href="#repository-pattern">Repository Pattern</a></li>
  <li><a href="#data-mapper-pattern">Data Mapper Pattern</a></li>
  <li><a href="#one-repository-per-entity">One Repository per Entity</a></li>
  <li><a href="#spring-data">Spring Data</a></li>
  <li><a href="#reference">Reference</a></li>
</ul>
    </div>
    <!-- toggle toc -->
    <script>
    function toggle_toc() {
        var popup = document.getElementById("popup_toc");
        popup.classList.toggle("show");
    }
    </script>
    <!-- scroll page -->
        <script>
    function scroll_percentage(mtpler) {
        document
        .getElementById("div_atcl")
        .scrollBy(0, window.innerHeight * mtpler);
    }
    </script>

<!-- toggle maximize -->

<script>
  var ctner_state = 0;
  var ctner = document.getElementById("ctner");
  function toggle_maximize() {
    if (ctner_state == 0) {
      ctner.style.width = "100%";
      ctner.style.height = "100%";
      ctner.style.top = "0";
      ctner.style.maxWidth = "100%";
      if (document.getElementById("mxmz_text")) {
        document.getElementById("mxmz_text").innerHTML = "Restore";
      }
      ctner_state = 1;
    } else if (ctner_state == 1) {
      ctner.style.width = "84%";
      ctner.style.height = "97%";
      ctner.style.top = "2%";
      ctner.style.maxWidth = "1240px";
      if (document.getElementById("mxmz_text")) {
        document.getElementById("mxmz_text").innerHTML = "Maximize";
      }
      ctner_state = 0;
    }
  }
</script>

<!-- encrypt and decrypt -->


      <div class="div_article" id="div_atcl">       
        <article id="main_atcl" itemscope itemtype="http://schema.org/BlogPosting">
          <h1>
  Apply Repository Pattern by Spring Data
</h1>
<div class="post_info">
  <!-- author -->
  
  <!-- date -->
  
  <span>
    <i class="fa fa-calendar"></i>
    Apr 16, 2020
  </span>
  
  <!-- category -->
  
  <span>
    <i class="fa fa-archive"></i>
    spring-boot
  </span>
  
</div>
<!-- abstract -->
<div class="abstract">
  
</div>

<div id="preamble">
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p>We code for compiling.</p>
</div>
<div class="paragraph">
<p>We code for running.</p>
</div>
<div class="paragraph">
<p>We code for changing.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="repository-pattern">Repository Pattern</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Mediates between the domain and data mapping layers using a collection-like interface for accessing domain objects.</p>
</div>
</blockquote>
</div>
<div class="paragraph">
<p>Domain Driven Design is domain centric, and domain data persistance (is abstracted as data mapping) is mandatory for almost application.</p>
</div>
<div class="paragraph">
<p>Repository plays as an interface between client code and data mapping layers, hides complexity and isolates changes of data mapping layers from client code.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/generated_diagrams/diag-5bb8a0f9b2aa50ba684bb435bf6a0962.png" alt="Diagram" width="374" height="418">
</div>
</div>
<div class="paragraph">
<p>Through repository, client code could access and persisten entity instances by collection-like and domain-centric interface. Because repository isolates changes of data mapping layers from client code, therefore it is easy to change data mapping layers implemenation. For example, it defines a repository interface and two implementations:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/generated_diagrams/diag-dbd212b9a8b6ed4b0ed14d98493030ee.png" alt="Diagram" width="325" height="200">
</div>
</div>
<div class="paragraph">
<p>When we changed the data mapping layer from JPA to MongoDB, it need not change any client code. Because client code depends on repository interface.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/generated_diagrams/diag-5e1c65a27b3dcfd6d9d67d0830d5c455.png" alt="Diagram" width="418" height="448">
</div>
<div class="title">Figure 1. JPA data mapping layer</div>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/generated_diagrams/diag-164625319346b449b4558c532db883eb.png" alt="Diagram" width="542" height="448">
</div>
<div class="title">Figure 2. MongoDB data mapping layer</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="data-mapper-pattern">Data Mapper Pattern</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>In software engineering, the data mapper pattern is an architectural pattern. It was named by Martin Fowler in this 2003 book Patterns of Enterprise Application Architecture. The interface of an object conforming to this pattern would include functions such as Create, Read, Update, and Delete, that operate on objects that represent domain entity types in a data store.</p>
</div>
<div class="paragraph">
<p>A Data Mapper is a Data Access Layer that performs bidirectional transfer of data between a persistent data store (often a relational database) and an in-memory data representation (the domain layer). The goal of the pattern is to keep the in-memory representation and the persistent data store independent of each other and the data mapper itself. The layer is composed of one or more mappers (or Data Access Objects), performing the data transfer. Mapper implementations vary in scope. Generic mappers will handle many different domain entity types, dedicated mappers will handle one or a few.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Data mapper pattern<br>
<cite>https://en.wikipedia.org/wiki/Data_mapper_pattern</cite>
</div>
</div>
<div class="paragraph">
<p>The pattern descibes data access by descriptive approach. It defines elements of in-memory data representation and data store, and maps them. Take Object/Relation Mapping as an example, it defines elements of object represnetation:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>class</p>
</li>
<li>
<p>object</p>
</li>
<li>
<p>field</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and defines elements of Relational database:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>table</p>
</li>
<li>
<p>record</p>
</li>
<li>
<p>column</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>and then maps them:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>class maps to table</p>
</li>
<li>
<p>object maps to record</p>
</li>
<li>
<p>field maps to column</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With data mapper pattern, application developer need not consider data access case by case, but describe the mapping of elements of in-memory and data store representations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="one-repository-per-entity">One Repository per Entity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Per <strong>Single-responsibility principle</strong>, one repository should only handle one entity.</p>
</div>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The single-responsibility principle (SRP) is a computer-programming principle that states that every module or class should have responsiblity over a single part of the functionality provided by the software, and that responsibility should be entirely encapsulated by the class, module or function. All its services should be narrowly aligned with that responsiblity. Robert C. Martin expresses the principle as "A class should have only one reason to change." although, because of confusion around the word "reason" he more recently stated "This principle is about people."</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Single-responsibility principle<br>
<cite>https://en.wikipedia.org/wiki/Single-responsibility_principle</cite>
</div>
</div>
<div class="paragraph">
<p>Keeping one repository per entity could benefit developer:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>make repository small and clean</p>
</li>
<li>
<p>changing data store solution per entity independently</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-data">Spring Data</h2>
<div class="sectionbody">
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>Spring Data&#8217;s mission is to provide a familiar and consistent, Spring-based programming model for data access while still retaining the special traits of the underlying data store.</p>
</div>
<div class="paragraph">
<p>It makes it easy to use data access technologies, relational and non-relational databases, map-reduce frameworks, and cloud-based data services. This is an umbrella project which contains many subprojects that are specifiv to a given database. The projects are developed by working together with many of the companies and developers that are behind these exciting technologies.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; Spring Data<br>
<cite>https://spring.io/projects/spring-data</cite>
</div>
</div>
<div class="paragraph">
<p>The core of Spring Data is Repository. Repositories of Spring data are organized in interface/abstract class/implementation class pattern. Take <code>InventoryItemRepository</code> as an example, it adopts RDMS as the data store of <code>InventoryItem</code>. Spring Data offers base interface <code>JpaRepository</code> and abstract class <code>SimpleJpaRepository</code> (<code>SimpleJpaRepository</code> is not implemented as an abstract class, but is designed as a base class for JPA repository implememntation class). Application developer defines entity-specific repository interface <code>InventoryItemRepository</code> which extends from interface <code>JpaRepository</code>. Spring Data will generate repository implementation <code>InventoryItemRepositoryImpl</code>.</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/generated_diagrams/diag-f0d6ed742ecde72d78e1ab149132ff17.png" alt="Diagram" width="461" height="287">
</div>
<div class="title">Figure 3. Spring Data Repository</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="reference">Reference</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Data_mapper_pattern">Data mapper pattern</a></p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Single-responsibility_principle">Single-responsibility principle</a></p>
</li>
</ul>
</div>
</div>
</div>

          

        </article>
          
      </div>
    </div>
  </body>
</html>
